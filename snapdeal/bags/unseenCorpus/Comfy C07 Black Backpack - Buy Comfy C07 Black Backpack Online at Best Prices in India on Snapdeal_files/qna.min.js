var Snapdeal=Snapdeal||{};Snapdeal.QnA=(function(F){var D,A,H;var G={},J={},I=window.isAuthenticated?true:false;function L(N){D=$.extend({},N,G,{tag:$("#tagsFilter").find("option:selected").val(),userNickName:"",qnaRegExp:/(<([^>]+)>)/ig,source:"source=qnaLandingPageDesktop",isLoading:false,},{isQnALandingPage:function(O){if(O.indexOf("/qna")!=-1&&O.indexOf("/qna/")==-1){return true}return false}(window.location.href),isQnALandingPerQuestion:function(O){if(O.indexOf("/qna/")!=-1){return true}return false}(window.location.href),pageNo:$("#pageNumber").val(),pageId:$("#pageId").val()||$("#pogId").val()||"",quesCount:$("#qnaNoOfQuestions").val(),ansCount:$("#qnaNoOfAnswers").val(),lastPage:$("#lastPage").val(),sortBy:$("#sortBy").val()||"lastActivityDate",tagsMap:"",isPDP:function(O){if(O.indexOf("/qna")!=-1){return false}return true}(window.location.href),tagsMapFlag:Boolean($("#tagsMapFlag").val()),catalogID:function(O){if(O.indexOf("/qna")!=-1){return $("#qnaCatalogId").val()}return $("#catalogId").val()}(window.location.href),productId:$("#productId").val(),questionsWrapper:$("#qna-questions-wrapper"),pageUrl:$("#pageUrl").val(),pathHttp:$("#pathHttp").val(),validators:{},loginState:window.isAuthenticated?true:false,isSearchLanding:function(O){if(O.indexOf("keyword")!=-1){return true}return false}(window.location.href),searchKeyword:$("#searchQnABox").val()});K();E();D.tag=((typeof D.tag)=="undefined"||D.tag=="undefined")?"":D.tag;C();if(D.isQnALandingPage){Snapdeal.omni.fire("qnaLandingRevamp",{catalogId:D.catalogID,sourceLink:"QNA"})}if(D.isQnALandingPerQuestion){Snapdeal.omni.fire("questionDetailsPage",{catalogId:$("#catalogId").val(),sourceLink:$("#source").val()})}$("#sdHeader").on("userLoggedIn",function(P,O){fn.updateLoginState(true,O)});D.tag=((typeof D.tag)=="undefined"||D.tag=="undefined")?"":D.tag;var M=$("#tagsFilter");Snapdeal.selectCommonConfigure.customSelect(M.parent())}function K(){A={body:$("body"),window:$(window),wrapper:$(".sd-qna"),qnaAnswersSiderBar:$("#qnaSideBarWriteAnswer"),qnaQuestionsSideBar:$("#qnaSideBarWriteQuestion"),submitAnswerButton:$("#submitAnswer"),submitQuestionButton:$("#submitQuestion"),qnaQuestionWrapper:$(".qna-question-wrapper"),controlHeader:$(".control-header"),askAQuestion:$("#ask-a-question"),havAQuestion:$(".ask-a-question"),radioLabel:$(".control-header").find(".radio-label"),guidelinesText:$(".guidelines-text"),alertCloseButton:$(".alert-error .close"),pagination:$(".LTblack"),redirectButton:$(".redirectionButton"),jumpToQNA:$(".jumpToQA"),gotItQues:$(".got-it-ques"),gotItAns:$(".got-it-ans"),backLink:$(".backLink"),sideBarModalRight:$("#sidebar_modal_right"),searchQnA:$(".searchQnA"),resetImage:$("#resetImg")}}function E(){B();A.qnaQuestionWrapper.on("click",".view-hide-answers",function(M){fn.expandAnswers.call(this,M,true)});A.qnaQuestionWrapper.on("click",".qna-upvote",fn.submitUpVote);A.qnaQuestionWrapper.on("click",".qna-answer-this-question",fn.answerQuestion);A.sideBarModalRight.on("click","#submitAnswer",fn.submitAnswer);A.sideBarModalRight.on("click","#cancelSubmitAnswer",fn.cancelSubmitAnswer);A.sideBarModalRight.on("click","#submitQuestion",fn.submitQuestion);A.sideBarModalRight.on("click","#cancelSubmitQuestion",fn.cancelSubmitQuestion);A.controlHeader.on("click",".radio-label",fn.sortByHandler);A.controlHeader.on("change","#tagsFilter",fn.filterChangeHandler);A.askAQuestion.on("click",function(M){Snapdeal.omni.fire("askAQuestionRevamp",{catalogId:D.catalogID,sourceLink:D.isPDP?"PDP":"QNA"});fn.askAQuestion.call(this)});A.havAQuestion.on("click",function(M){Snapdeal.omni.fire("haveAQuestion",{catalogId:D.catalogID,sourceLink:D.isPDP?"PDP":"QNA"});fn.askAQuestion.call(this)});A.guidelinesText.on("click",fn.showGuidelines);A.alertCloseButton.on("click",fn.showForm);A.redirectButton.on("click",fn.takeBackToPage);A.jumpToQNA.on("click",function(M){Snapdeal.omni.fire("jumpToQNA",{catalogId:D.catalogID,sourceLink:D.isPDP?"PDP":"QNA"})});A.gotItQues.on("click",function(M){Snapdeal.omni.fire("gotItQues",{catalogId:D.catalogID,sourceLink:D.isPDP?"PDP":"QNA"})});A.gotItAns.on("click",function(M){Snapdeal.omni.fire("gotItAns",{catalogId:D.catalogID,sourceLink:D.isPDP?"PDP":"QNA"})});A.backLink.on("click",function(M){});A.sideBarModalRight.on("click",".qna-checkbox-container input[type='radio'],.qna-checkbox-container input[type='checkbox']",function(M){$(this).addClass("show-ripple");setTimeout(function(){$(this).removeClass("show-ripple")},500)});A.searchQnA.on("keydown",fn.search);A.resetImage.on("click",fn.resetQnA);if(D.isPDP){A.wrapper.one("click",function(M){Snapdeal.omni.fire("pdpQnAUserVisit",{catalogId:D.catalogID})})}$("#searchQnABox").on("focus",function(N){var M=$(this);if(M.val().length){M.css("opacity","1")}else{M.css("opacity","0.6")}}).on("blur",function(N){var M=$(this);M.css("opacity","1")}).on("keydown",function(N){var M=$(this);M.css("opacity","1")})}function B(){}function C(){fn.getUserDetails();D.validators.answerSubmissionFormValidator=$("#answerSubmissionForm").validate({rules:{"qna-answer-textarea":{required:true,minlength:1,},"qna-user-nick-name":{required:true,minlength:1,},},messages:{"qna-user-nick-name":"Please enter nickname","qna-answer-textarea":"Please enter your answer",},errorElement:"div",errorClass:"error"});D.validators.questionSubmissionFormValidator=$("#questionSubmissionForm").validate({rules:{"qna-submit-question-textarea":{required:true,minlength:1,},"qna-user-nick-name-for-question":{required:true,minlength:1,},},messages:{"qna-user-nick-name-for-question":"Please enter nickname","qna-submit-question-textarea":"Please enter your question",},errorElement:"div",errorClass:"error"});if(D.isQnALandingPage&&!D.isSearchLanding){promise1=fn.appendQuestions();$.when(promise1).done(fn.stopLoadingScreen)}if(D.isSearchLanding){D.isSearch=true;var O=window.location.href;var N=O.split("keyword");var Q=N[1].split("=");var P=decodeURI(Q[1]);D.searchKeyword=P;var M=document.getElementById("searchQnABox");M.value=P;$(".sortBy").hide();$(".mostHelpful").hide();$(".mostRecent").hide();$("#resetmessage").show();$("#searchQnABox").value="battr";promise1=fn.searchQnA(D.searchKeyword,D.tag);$.when(promise1).done(fn.stopLoadingScreen)}}fn={init:L,initializePage:C,startLoadingScreen:function(){D.isLoading=true;Snapdeal.utility.displayPageLoader()},stopLoadingScreen:function(){D.isLoading=false;Snapdeal.utility.hidePageLoader()},expandAnswers:function(P,O){var N,Q,M;N=$(this);if(!N.hasClass("qna-question")){N=$(this).parents(".qna-question")}if(O){N.siblings().removeClass("expanded").find(".qna-answers").hide().toggleClass("expanded");N.siblings().find(".view-hide-answers").show();$(".ajax-loader-icon").hide()}Q=N.find(".qna-answers");setTimeout(function(){if(O){if(N.hasClass("expanded")){Q.hide();N.toggleClass("expanded");N.find(".view-hide-answers").show();$(".ajax-loader-icon").hide()}else{N.toggleClass("expanded");Snapdeal.omni.fire("questionExpanded",{catalogId:D.catalogID,quesId:N.attr("_quesid"),sourceLink:D.isPDP?"PDP":"QNA"});Q.show();if(N.attr("data-all-answers-loaded")=="false"){N.find(".ajax-loader-icon").show();(function(R){fn.appendAnswer(R)})(N.attr("data-question-id"))}N.find(".view-hide-answers").hide();$(window).scrollTo(N.offset().top-60,"slow")}}else{if(N.hasClass("expanded")){}else{M=Q.is(":visible");$(".qna-question").removeClass("expanded");$(".qna-answers").hide();N.toggleClass("expanded");if(!M){Snapdeal.omni.fire("questionExpanded",{catalogId:D.catalogID,quesId:N.attr("_quesid"),sourceLink:D.isPDP?"PDP":"QNA"});Q.show();if(N.attr("data-all-answers-loaded")=="false"){N.find(".ajax-loader-icon").show();(function(R){fn.appendAnswer(R)})(N.attr("data-question-id"))}$(window).scrollTo(N.offset().top-60,"slow")}}}},700)},submitUpVote:function(Q){var P=$(this);var O="",M="upvote";if(P.prop("disabled")){return }O=$(".userLoginEmail").eq(1).text();M=P.hasClass("unvote")&&"unvote"||"upvote";D.currentQuestionID=P.attr("data-question-id");D.currentAnswerID=P.attr("data-answer-id");var R={postId:D.currentAnswerID,voteTypeId:M,postOwnerEmail:O,postTypeCode:"answer",postParentId:D.currentQuestionID};Snapdeal.omni.fire("qnaVote",{catalogId:D.catalogID,ansId:D.currentAnswerID,action:M,sourceLink:D.isPDP?"PDP":"QNA"});if(D.loginState){P.prop("disabled",true);var N="/posts/vote";Snapdeal.rippleWidget.rippleCallBack(P,Q);$.ajax({url:N,type:"POST",contentType:"application/json;charset=UTF-8",data:JSON.stringify(R),dataType:"json",success:function(S){$("#vote_"+D.currentAnswerID).html(S.score+"<i></i><u></u>");P.toggleClass("unvote");P.parent().toggleClass("yesClicked");if(P.attr("src")===Snapdeal.getResourcePath("/")+"/img/upvote.png"){P.attr("src",Snapdeal.getResourcePath("/")+"/img/no-like.png")}else{P.attr("src",Snapdeal.getResourcePath("/")+"/img/upvote.png")}},error:function(S){},complete:function(){fn.stopLoadingScreen();P.prop("disabled",false)}})}else{fn.saveVotingState(R);fn.showLogin()}},appendQuestions:function(M){if(!D.pageId){throw ("Error: 'pageId' is missing - Unable to fetch 'Questions and Answers'");return }var N,O;if(true){N="/posts/page/"+D.pageId+"/question?"+D.source+"&page="+D.pageNo+"&sortBy="+D.sortBy+"&tag="+D.tag;O=$.ajax({url:N,success:function(Q){if(Q.posts.length>0){A.qnaQuestionWrapper&&A.qnaQuestionWrapper.html(fn.getQuestionHTML(Q.posts));Q.totalResults=Q.totalResults||0;for(var P=0;P<Q.posts.length;P++){(function(R){fn.appendAnswer(R)})(Q.posts[P].id)}$(".pagination").show()}else{A.qnaQuestionWrapper&&A.qnaQuestionWrapper.html("<div  style='text-align: center; margin-top : 40px; font-size:18px;font-family: robotoLight;'>No Results Found</div>");$(".pagination").hide()}M&&M(Q)},error:function(){A.qnaQuestionWrapper&&A.qnaQuestionWrapper.html("<div style='text-align: center; margin-top : 40px; font-size:18px;font-family: robotoLight;'>No Results Found</div>")}});return O}},getQnACount:function(O){var M,N;M="/posts/count/"+D.pageId+"?source=pdpDesktop";N=$.ajax({url:M,success:function(P){O&&O(P)},error:function(P){}});return N},getQuestionHTML:function(O){var N=0,M=[],Q;var R=window.location.pathname;var P;if(D.isPDP){P="PDP";R=R+"/qna"}else{P="QNALanding"}for(;N<O.length;N++){Q=O[N];M.push('<li class="qna-question clearfix" id="',Q.id,'" data-question-id="',Q.id,'" _quesid="',Q.id,'" data-all-answers-loaded="false">','<div class="qBlock">','<span class="qna-ques-head"><span class="ques-icon">Q</span><div class="qright-info"><a href="'+R+"/"+Q.id+"?source="+P+'"><span class="ques">'+Q.body,"</span></a></div></span>","</div>",(Q.answerCount==0)?('<div class="noAns">No Answer</div><div class="ansButton"> <button class="btn btn-large rippleWhite btn-lg-ask qna-answer-this-question blackBtn" data-question-id="'+Q.id+'">ANSWER QUESTION</button></div>'):"",(Q.answerCount!=0)?('<div class="'+Q.id+'_qa_pair"></div>'):"",'<div class="qna-answers" style="display:none;">',"</div>",'<div align="center" class="mar_15per_left ajax-loader-icon" style="display:none;">','<img src="',Snapdeal.getResourcePath("img/revamp/cyclicLoader.gif"),'" />',"</div>",(Q.answerCount>0)?(' <div class="view-hide-answers"><span>View All Answers </span><span> ( '+Q.answerCount+' )</span><i id= "view-hide-icon" class="sd-icon sd-icon-expand-arrow"/></div>'):"","</li>")}return M.join("")},getQAPairHTML:function(N){var M=[],O,P;if(D.isSearch){O=N.bestAnswer}else{O=N[0]}M.push("<p>",'<div class="dotted-line"></div>','<div class="response-text"><span class="ques-icon">A</span><div class="right-info"><span class="ans">',O.body.trim(),"</span>","",'<div class="qna-ques-userInfo" >by <span class="qna-display-name">',O.createdBy.displayName,'</span> | <time datetime="',O.createdDate,'">',O.createdDate,"</time></div></div>","</div>",'<span class="arrow"></span><div class="qna-ans-cnt qna-upvote-border">','<i id="vote" class="align-icon qna-upvote ',(O.currentUserVoteTypeId==null?"sd-icon sd-icon-thumbs-up-icon--new":"sd-icon sd-icon-thumbs-up-icon--new"),'" data-answer-id="',O.id,'" data-question-id="',O.parentId,'" data-user-email="',O.createdBy.email,O.currentUserVoteTypeId!=null?'class="qna-upvote unvote rippleGrey"></i>':'" class="qna-upvote rippleGrey"/>','<span id="vote_',O.id,'"class="alignVote">',O.upvoteCount,"<i></i><u></u></span>","</span></div><i></i>","</p>");return M.join("")},answerQuestion:function(N){var M=$(this);var O=M.attr("_val");D.currentQuestionID=M.attr("data-question-id");D.userNickName&&D.userNickName.length&&$("#qna-user-nick-name").val(D.userNickName).prop("readonly",true).addClass("disabled");Snapdeal.omni.fire("qnaAnswerQuestion",{catalogId:D.catalogID,quesId:D.currentQuestionID,sourceLink:D.isPDP?"PDP":"QNA"});if(window.isAuthenticated){Snapdeal.sidebar.open(A.qnaAnswersSiderBar,"Your answer can help millions!","sd-qna sd-qna-popup-override")}else{window.showLogin();return false}fn.getQnaOmnitureScript({catalogId:D.catalogID,sourceLink:"topAnswerLink"},"clickAnswerQuestion")},appendAnswer:function(M){var N;if(M){D.currentQuestionID=M}N="/posts/parent/"+D.currentQuestionID+"?sortBy=score&size=99999";setTimeout(function(){$.ajax({url:N,success:function(O){if(O&&O.answerCount!=0){$("#"+M).find(".qna-answers").html(['<ul class="qna-answers-wrapper container-fluid"></ul>','<div class="ansButton"><button class="btn btn-large rippleWhite btn-lg-ask qna-answer-this-question blackBtn" data-question-id="',M,'">ANSWER QUESTION</button></div>'].join(""))}if(O&&O.posts&&O.posts.length>0){$("."+M+"_qa_pair").html(fn.getQAPairHTML(O.posts));$("#"+M).find("ul").before("<h4></h4>").html(fn.getAnswerHTML(O.posts))}}}).complete(function(){fn.stopLoadingScreen();$("#"+M).attr("data-all-answers-loaded","true").find(".ajax-loader-icon").remove()})},1000)},appendSearchAnswer:function(M,N){var O;if(M){D.currentQuestionID=M}O="/posts/parent/"+D.currentQuestionID+"/search/?keywords="+N+"&size=99999";setTimeout(function(){$.ajax({url:O,success:function(P){if(P){$("#"+M).find(".qna-answers").html(['<ul class="qna-answers-wrapper container-fluid"></ul>','<div class="ansButton"><button class="btn btn-large rippleWhite btn-lg-ask qna-answer-this-question blackBtn" data-question-id="',M,'">ANSWER QUESTION</button></div>'].join(""))}if(P&&P.posts&&P.posts.length>0){$("#"+M).find("ul").before("<h4></h4>").html(fn.getAnswerHTML(P.posts))}}}).complete(function(){fn.stopLoadingScreen();$("#"+M).attr("data-all-answers-loaded","true").find(".ajax-loader-icon").remove()})},1000)},getAnswerHTML:function(O){var N=1,M=[],Q,P=8;for(;N<O.length;N++,P++){Q=O[N];M.push('<li class="row" id="',Q.id,'" data-answer-id="',Q.id,'" data-question-id="',Q.id,'">','<span class="response-text">',Q.body.trim(),"</span>",'<div class="qna-ques-userInfo">by <span class="qna-display-name">',Q.createdBy.displayName,'</span> | <time datetime="',Q.createdDate,'">',Q.createdDate,"</time></div>","</span></div>",'<div class="qna-ans-cnt qna-upvote-border moreAns">','<i id="vote" class="align-icon qna-upvote ',(Q.currentUserVoteTypeId==null?"sd-icon sd-icon-thumbs-up-icon--new":"sd-icon sd-icon-thumbs-up-icon--new"),'" data-answer-id="',Q.id,'" data-question-id="',Q.parentId,'" data-user-email="',Q.createdBy.email,Q.currentUserVoteTypeId!=null?'" class="qna-upvote unvote rippleGrey"/>':'" class="qna-upvote rippleGrey"/>','<span id="vote_',Q.id,'"class="alignVote">',Q.upvoteCount,"</span></div>","</li>")}return M.join("")},getUserDetails:function(){if(D.loginState==true){return }},updateLoginState:function(M,N){D.loginState=M;if(M){fn.getUserName()}},showGuidelines:function(M){Snapdeal.sidebar.open($("#qnaSideBarQnAGuidelines"),"Guidelines","sd-qna")},getQnaOmnitureScript:function(N,M){var O;O="/qna/getomniturescript/"+M+"?"+$.param(N);return $.ajax({url:O,type:"POST",contentType:"application/json; charset=utf-8",dataType:"html",success:function(P){$("body").append(P)},error:function(){$(".ajax-loader-icon").hide()}})},askAQuestion:function(M){D.userNickName&&D.userNickName.length&&$("#qna-user-nick-name-for-question").val(D.userNickName).prop("readonly",true).addClass("disabled");if(window.isAuthenticated){Snapdeal.sidebar.open(A.qnaQuestionsSideBar,"Have a question?","sd-qna sd-qna-popup-override")}else{window.showLogin();return false}},sortByHandler:function(O){var N=$(this),M;A.radioLabel.removeClass("selected");D.sortBy=N.attr("data-sort-by");D.pageNo=1;N.addClass("selected");Snapdeal.omni.fire("qnaSortBy",{catalogId:D.catalogID,typeOfSorting:D.sortBy,sourceLink:D.isPDP?"PDP":"QNA"});M=fn.appendQuestions(fn.generatePagination);$.when(M).done(fn.stopLoadingScreen)},takeBackToPage:function(O){var N,M;N=$(this);M=N.attr("data-form-name")||"";N.parents(".qna-success-message").fadeOut("slow",function(){$(M).fadeIn()});fn.cancelSubmitQuestion.call(this,O,true);fn.cancelSubmitAnswer.call(this,O,true);Snapdeal.sidebar.close()},showForm:function(O){var N,M;N=$(this);M=N.attr("data-form-name")||"";N.parents(".alert-error").fadeOut("slow",function(){$(M).fadeIn()})},filterChangeHandler:function(O){var N,M,P;N=$(this);D.tagText=N.find("option:selected").text();D.tag=N.find("option:selected").val();D.pageNo=1;console.log("Tag "+D.tag);D.tag=((typeof D.tag)=="undefined"||D.tag=="undefined")?"":D.tag;Snapdeal.omni.fire("qnaFilterSelect",{catalogId:D.catalogID,typeOfSorting:D.sortBy,typeOfTag:D.tagText,sourceLink:D.isPDP?"PDP":"QNA"});M=fn.getQnACount(function(Q){});if(D.isSearch){promise2=fn.searchQnA(D.searchKeyword,D.tag)}else{promise2=fn.appendQuestions(fn.generatePagination)}$.when(M,promise2).done(fn.stopLoadingScreen)},showLogin:function(){var M;M=window.showLogin||Snapdeal.showLogin||function(){window.location.href="/login"};M()},saveVotingState:function(N){var M;M=Snapdeal.localStorage&&Snapdeal.localStorage.getItem(D.pageId+"_qna_content");M=M&&JSON.parse(M)||{};M.activity=M.activity||[];M.activity.push({voteup:N});Snapdeal.localStorage&&Snapdeal.localStorage.setItem(D.pageId+"_qna_content",JSON.stringify(M))},omnitureScriptForSubmitAnswer:function(){},submitAnswer:function(P){P.preventDefault();if($("html").hasClass("ie8")||$("html").hasClass("ie9")){var R="Kindly ensure your answers are to the point or elaborate accordingly.";if($("#qna-answer-textarea").val().trim()==R){$("#qna-answer-textarea").val("")}}A.userNickName=$("#qna-user-nick-name");A.answerTextArea=$("#qna-answer-textarea");A.userNickName.val(A.userNickName.val().trim().replace(D.qnaRegExp,""));A.answerTextArea.val(A.answerTextArea.val().trim().replace(D.qnaRegExp,""));if(!D.loginState){D.currentAnswer=Snapdeal.localStorage&&localStorage.getItem(D.currentQuestionID+"QnaAns")||"";if(Snapdeal.localStorage&&localStorage.getItem(D.currentQuestionID+"QnaAns")){$("#"+D.currentQuestionID+"_qnaAns").val()=localStorage.getItem(D.currentQuestionID+"QnaAns")}fn.showLogin()}if($("#answerSubmissionForm").valid()){var O,N,Q;O=$(this);if(O.not(":disabled")[0]){O.prop("disabled",true);D.userNickName=A.userNickName.val()?A.userNickName.val().trim().replace(D.qnaRegExp,""):"";Q=A.answerTextArea.val()?A.answerTextArea.val().trim().replace(D.qnaRegExp,""):"";N="/posts/answer?name="+D.userNickName;Snapdeal.omni.fire("submitAnswer",{catalogId:D.catalogID,quesId:D.currentQuestionID,sourceLink:D.isPDP?"PDP":"QNA"});fn.startLoadingScreen();$.ajax({url:N,type:"POST",dataType:"JSON",contentType:"application/json; charset=utf-8",data:JSON.stringify({pogId:D.pageId,parentId:D.currentQuestionID,body:Q}),success:function(){$("#answerSubmissionForm").fadeOut("medium",function(){$("#answerSubmissionSuccess").fadeIn("medium")})},error:function(){$("#answerSubmissionForm").fadeOut("medium",function(){$("#answerSubmissionError").fadeIn("medium",function(){O.prop("disabled",false)})})}}).complete(M)}}function M(){fn.stopLoadingScreen()}},omnitureScriptForSubmitQuestion:function(){},submitQuestion:function(N){N.preventDefault();if($("html").hasClass("ie8")||$("html").hasClass("ie9")){var O="- Questions on products and its features.";if($("#qna-submit-question-textarea").val().trim()==O){$("#qna-submit-question-textarea").val("")}}A.userNickName=$("#qna-user-nick-name-for-question");A.submitQuestionTextArea=$("#qna-submit-question-textarea");A.userNickName.val(A.userNickName.val().trim().replace(D.qnaRegExp,""));A.submitQuestionTextArea.val(A.submitQuestionTextArea.val().trim().replace(D.qnaRegExp,""));if(!D.pageId){return }if(!D.loginState){D.currentAnswer=Snapdeal.localStorage&&localStorage.getItem(D.currentQuestionID+"QnaAns")||"";if(Snapdeal.localStorage&&localStorage.getItem(D.currentQuestionID+"QnaAns")){$("#"+D.currentQuestionID+"_qnaAns").val()=localStorage.getItem(D.currentQuestionID+"QnaAns")}fn.showLogin()}if($("#questionSubmissionForm").valid()){var W,T,Q,X,S,R=[];W=$(this);if(W.not(":disabled")[0]){W.prop("disabled",true);D.userNickName=A.userNickName.val()?A.userNickName.val().trim().replace(D.qnaRegExp,""):"";Q=A.submitQuestionTextArea.val()?A.submitQuestionTextArea.val().trim().replace(D.qnaRegExp,""):"";T="/posts/question?name="+D.userNickName;X=$(this).closest("form");if(D.tagsMapFlag){function V(Z){var Y={};Y.id=Z;return Y}S=X.find("input[type='checkbox']");if(S&&S.length!=0){for(var M=0;M<S.length;M++){var U=S[M];if($(U).is(":checked")){R[R.length]=new V($(U).attr("id"))}}}}Snapdeal.omni.fire("submitQuestion",{catalogId:D.catalogID,sourceLink:D.isPDP?"PDP":"QNA"});fn.startLoadingScreen();$.ajax({url:T,type:"POST",dataType:"JSON",contentType:"application/json; charset=utf-8",data:JSON.stringify({pogId:D.pageId,body:Q,postTags:R}),success:function(){$("#questionSubmissionForm").fadeOut("medium",function(){$("#questionSubmissionSuccess").fadeIn("medium")})},error:function(){$("#questionSubmissionForm").fadeOut("medium",function(){$("#questionSubmissionError").fadeIn("medium")});$("#questionSubmissionForm").fadeOut("medium",function(){$("#questionSubmissionError").fadeIn("medium",function(){W.prop("disabled",false)})})}}).complete(P)}}function P(){fn.stopLoadingScreen()}},cancelSubmitQuestion:function(N,M){N.preventDefault();if(!M){Snapdeal.omni.fire("cancelQuestion",{catalogId:D.catalogID,sourceLink:D.isPDP?"PDP":"QNA"})}D.validators.questionSubmissionFormValidator.resetForm();$("#qna-user-nick-name-for-question").val(D.userNickName);A.submitQuestionButton.prop("disabled",false)},cancelSubmitAnswer:function(N,M){N.preventDefault();if(!M){Snapdeal.omni.fire("cancelAnswer",{catalogId:D.catalogID,quesId:D.currentQuestionID,sourceLink:D.isPDP?"PDP":"QNA"})}D.validators.answerSubmissionFormValidator.resetForm();$("#qna-user-nick-name").val(D.userNickName);A.submitAnswerButton.prop("disabled",false)},search:function(N){if(N.keyCode==13){var M=document.getElementById("searchQnABox").value;if(M.match(/^\s*$/)){fn.resetQnA()}else{D.pageNo=1;fn.searchQnA(M,D.tag);if(D.isQnALandingPage){Snapdeal.omni.fire("Submit_QnASearch",{catalogId:D.catalogID,clickSource:"QNALanding",keyword:M})}else{Snapdeal.omni.fire("Submit_QnASearch",{catalogId:D.catalogID,clickSource:"PDP",keyword:M})}}}},searchQnA:function(N,M){if(!D.pageId){throw ("Error: 'pageId' is missing - Unable to fetch 'Questions and Answers'");return }if(M.match(/^\s*$/)){var O="/posts/products/"+D.productId+"/question/search?keywords="+N+"&page="+D.pageNo}else{var O="/posts/products/"+D.productId+"/question/search?keywords="+N+"&page="+D.pageNo+"&tagId="+M}D.sortBy="search";D.isSearch=true;D.searchKeyword=N;$("#resetmessage").hide();$("#loadingmessage").show();var P=$.ajax({url:O,type:"GET",dataType:"html",success:function(T){$(".sortBy").hide();$(".mostHelpful").hide();$(".mostRecent").hide();$("#loadingmessage").hide();var S=JSON.parse(T);if(S.posts.length>0){$("#resetmessage").show();$("#qna-count-heading").show();$(".filterByListItem").show();$(".last-child").show();if(D.isQnALandingPage){$("#ask-a-question-search").show()}A.qnaQuestionWrapper&&A.qnaQuestionWrapper.html(fn.getQuestionHTML(S.posts));S.totalResults=S.totalResults||0;if(S.totalResults>5){$(".pagination").show()}for(var R=0;R<S.posts.length;R++){var Q=S.posts[R].id;$("."+Q+"_qa_pair").html(fn.getQAPairHTML(S.posts[R]));(function(U){fn.appendSearchAnswer(U,N)})(Q)}}else{$("#resetmessage").show();$("#qna-count-heading").hide();$(".filterByListItem").hide();$(".last-child").hide();A.qnaQuestionWrapper&&A.qnaQuestionWrapper.html('<div style="text-align: center; margin-top : 40px; font-size:18px;font-family: robotoLight;">No matching search result found <button class="btn rippleWhite btn-lg-ask askQuestionButton blackBtn" id="ask-a-question">Ask a question</button></div>');$(".pagination").hide();$("#ask-a-question-search").hide();A.askAQuestion=$("#ask-a-question");A.askAQuestion.on("click",function(U){Snapdeal.omni.fire("askAQuestionRevamp",{catalogId:D.catalogID,sourceLink:D.isPDP?"PDP":"QNA"});fn.askAQuestion.call(this)})}fn.generatePagination(S)},error:function(){A.qnaQuestionWrapper&&A.qnaQuestionWrapper.html("<div style='text-align: center; margin-top : 40px; font-size:18px;font-family: robotoLight;'>No Results Found</div>")}});return P},resetQnA:function(){D.isSearch=false;D.pageNo=1;A.radioLabel.removeClass("selected");D.sortBy="score";$("#mostHelpfulLabel").addClass("selected");$("#resetmessage").hide();$("#ask-a-question-search").hide();fn.appendQuestions(fn.generatePagination);var M=document.getElementById("searchQnABox");M.value="";$(".mostHelpful").show();$(".mostRecent").show();$(".filterByListItem").show();$(".last-child").show();$("#qna-count-heading").show()},getUserName:function(){var M,N;M=Snapdeal.Cookie.get("eid");D.eid=M;if(!M){return }N=$.ajax({url:"/snapboard/user?email="+M.replace(/"/g,""),type:"GET",dataType:"json",success:function(O){D.userNickName=O.displayName;D.loginState=true;$("#qna-user-nick-name").val(D.userNickName);fn.pendingUpvoteHit()}});return N},pendingUpvoteHit:function(){if(D.loginState){var M,P="";M=Snapdeal.localStorage&&Snapdeal.localStorage.getItem(D.pageId+"_qna_content");M=M&&JSON.parse(M)||{};M.activity=M.activity||[];if(M.activity[0]&&M.activity[0].voteup){var O=M.activity[0].voteup,N=$("#"+O.postId);O.postOwnerEmail=$(".userLoginEmail").eq(1).text();N.prop("disabled",true);P=M.activity[0].voteup.postParentId;$.ajax({url:"/posts/vote",type:"POST",contentType:"application/json;charset=UTF-8",data:JSON.stringify(O),dataType:"json",success:function(Q){$("#vote_"+O.postId).html(Q.score+"<i></i><u></u>");N.toggleClass("unvote");if(N.attr("src")===Snapdeal.getResourcePath("/")+"/img/upvote.png"){N.attr("src",Snapdeal.getResourcePath("/")+"/img/no-like.png")}else{N.attr("src",Snapdeal.getResourcePath("/")+"/img/upvote.png")}},error:function(Q){},complete:function(){fn.stopLoadingScreen();if(P!==""){var Q=jQuery("#"+P);if(Q.length>0){jQuery("html, body").animate({scrollTop:Q.offset().top},"slow",function(){Q.click()})}}N.prop("disabled",false);M.activity=[];Snapdeal.localStorage&&Snapdeal.localStorage.setItem(D.pageId+"_qna_content",JSON.stringify(M))}})}}},changePaginationHREFs:function(M){},generatePagination:function(U){var M,W,b,V,O,S,R,Q,Z,N=[],X,a;X=(D.tag=="")?"":("&tag="+D.tag);W=U.lastPage;M=U.pageCriteria.page;b=window.location.href.split("/qna")[0]+"/qna";a=(D.isSearch)?("&keyword="+D.searchKeyword):"";if(D.isSearch){S=U.totalResults/U.pageCriteria.size;S=Math.ceil(S);R=U.totalResults}else{S=D.tag.length?U.totalResults/U.pageCriteria.size:D.quesCount/U.pageCriteria.size;S=Math.ceil(S);R=D.tag.length?U.totalResults:D.quesCount}if(D.isQnALandingPage){if(!(M==1&&W)){N.push('<li class="first">');if(M==1){N.push('<i class="sd-icon sd-icon-previous nav-disable-qna"></i>')}else{if(M-1==1){N.push('<a href="',b,"?page=&sortBy=",D.sortBy,X,'" class="rippleGrey"><i class="sd-icon sd-icon-previous"></i></a>')}else{N.push('<a href="',b,"?page=",M-1,"&sortBy=",D.sortBy,X,'" class="rippleGrey"><i class="sd-icon sd-icon-previous"></i></a>')}}N.push("</li>");if(M==1){N.push('<li><span class="rippleGrey"><a href="javascript:void(0)">1</a></span></li>')}else{N.push('<li><a href="',b,"?&sortBy=",D.sortBy,X,a,'" class="rippleGrey">1</a></li>')}if(M-1>2){N.push("<li><i>...</i></li>")}Q=M>2?(M-1):2;Z=(S<M+2?S-1:M+1);for(var T=Q;T<=Z;T++){N.push("<li>");if(T==M){N.push('<span class="rippleGrey"><a href="javascript:void(0)">',T,"</a></span>")}else{if((M-1)==1){N.push('<a href="',b,"?&sortBy=",D.sortBy,X,a,'" class="rippleGrey">',T,"</a>")}else{N.push('<a href="',b,"?page=",T,"&sortBy=",X,a,'" class="rippleGrey">',T,"</a>")}}N.push("</li>")}if(S-M>2){N.push("<li><i>...</i></li>")}if(S!=1){if(M==S){N.push('<li><span class="rippleGrey"><a href="javascript:void(0)">'+S+"</a></span></li>")}else{N.push('<li><a href="',b,"?page=",T,"&sortBy=",D.sortBy,X,a,'" class="rippleGrey">'+S+"</a></li>")}}N.push('<li class="last">');if(W){N.push('<a href="javascript:void(0);"><i class="sd-icon sd-icon-previous nav-disable-qna" ></i>')}else{N.push('<a href="',b,"?page=",M+1,"&sortBy=",D.sortBy,X,a,'" class="rippleGrey"><i class="sd-icon sd-icon-next"></i>')}N.push("</a>","</li>")}A.pagination.html(N.join(""))}var P=D.tag?"&tag="+D.tag:"";if(D.sortBy=="search"){if(D.pageNo==1){if(U.posts.length!=0){$("#qna-count-heading").html("Displaying Search Results  1 - "+U.posts.length+" of "+R).show()}}else{$("#qna-count-heading").html("Displaying Search Results "+(1+((U.pageCriteria.page-1)*U.pageCriteria.size))+"-"+(U.posts.length+((U.pageCriteria.page-1)*U.pageCriteria.size))+" of "+R).show()}}else{$("#qna-count-heading").html("Displaying Questions  1 - "+U.posts.length+" of "+R).show()}if(!W){var Y="View more helpful questions";if(D.sortBy=="lastActivityDate"){Y="View more recent questions"}else{if(D.sortBy=="search"){Y="View all search results"}}O=$(".qna-load-more").prop("href")||"";$(".qna-load-more").html(Y).show().prop("href",O.split("sortBy=")[0]+"sortBy="+D.sortBy+P+a)}else{if(U.posts.length==0){$("#qna-count-heading").html("Displaying Questions  0 of 0")}$(".qna-load-more").hide()}}};H={init:function(M){return fn.init(M)},updateLoginState:function(M){return fn.updateLoginState(M)},};return H})();Snapdeal.QnA.init({});
