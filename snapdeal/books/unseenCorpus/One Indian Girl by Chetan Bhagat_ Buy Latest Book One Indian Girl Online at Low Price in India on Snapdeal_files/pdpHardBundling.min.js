var Snapdeal=Snapdeal||{};Snapdeal.pdpHardBundling=(function(){var C,A,B;A={hardBundlingContainer:$(".hardBundleContainer"),attrOptions:$("#product-attr-options"),contentWrapper:$("#content_wrapper")};window.hbund=B={_init:function(E,D){B._supc=E;B._quickViewCss=D;B._addToCartListener();B._tabClickListener();A.attrOptions.on("productAttrSelectedAtSecondaryLocation",function(I,H,G,J){Snapdeal.utility.hidePageLoader();var F=Snapdeal.Cookie.get("spin");if((F&&H.vendorInfo.servicableVendorCount>0)||!F){Snapdeal.shoppingCart.addToCart(B._addTocartData.catalog?B._addTocartData.catalog:B._selectedDom.parents(".pdpHardBundlingParentContainer").find(".attributesBundle").attr("catalogId"),H.primaryVendor.vendorCode,G,"","","","","",event);B._addTocartData={}}else{}});A.contentWrapper.on("nonPdpPageAttrSelectedBundle",function(H,G,F){B._addTocartData={supc:G,catalog:F};Snapdeal.utility.displayPageLoader();Snapdeal.sidebar.close()});A.hardBundlingContainer.on("click",".dp-widget-link",function(I){I.preventDefault();I.stopPropagation();var F=$(this);var H=$(this).parents(".hardBundleContainer").find(".tabs-bundle .tab.active").index();B._clickedDomForQuickViewBundle=F;if(!Snapdeal.quickViewCssLoaded){var G=(Snapdeal.pdpConfigs&&Snapdeal.pdpConfigs.quickViewCss)?loadCSS(Snapdeal.pdpConfigs.quickViewCss):loadCSS(B._quickViewCss);onloadCSS(G,function(){$("body").trigger("quickViewCssLoaded",[]);Snapdeal.quickViewCssLoaded=true})}$.ajax({url:"/quickView/"+F.attr("pogId")+"?isBundlingFlow=true",cache:true,type:"GET",beforeSend:function(){Snapdeal.sidebar.showLoader()},success:function(J){if(Snapdeal.quickViewCssLoaded){Snapdeal.sidebar.hideLoader();Snapdeal.sidebar.open($("<div>",{html:J}),"Details","bundleQuickview");$("body").on("click",".prodDetailBtn",function(){Snapdeal.Cookie.set("track","RID=hardBundle_"+H)})}else{$("body").on("quickViewCssLoaded",function(K){Snapdeal.sidebar.hideLoader();Snapdeal.sidebar.open($("<div>",{html:J}),"Details","bundleQuickview")});$("body").on("click",".prodDetailBtn",function(){Snapdeal.Cookie.set("track","RID=hardBundle_"+H)})}},error:function(J){}})});$("body").on("click",".addToCartQuickViewBundling",function(F){F.preventDefault();F.stopPropagation();Snapdeal.sidebar.close();setTimeout(function(){B._clickedDomForQuickViewBundle.parents(".pdpHardBundlingParentContainer").find(".pdpHardBundlingAddtoCart").click()},10)})},_clickedDomForQuickViewBundle:"",_addTocartData:{},_supc:"",_tabClickListener:function(){A.hardBundlingContainer.on("click.hardBundleTab",".tabs-bundle li",function(E){var D=$(this);A.hardBundlingContainer.find(".tab-container-bundle .bundletabdesc").addClass("hidden");$("#"+D.attr("toshow")).removeClass("hidden");A.hardBundlingContainer.find(".tabs-bundle li").removeClass("active");D.addClass("active");B._clickedIndex=parseInt(D.attr("index"));if(!B["_tab"+B._clickedIndex+"Slider"]){B._getProducts()}else{B._reloadTabSlider()}})},_quickViewCssLoaded:false,_setTabSlider:function(D){setTimeout(function(){if(!B["_tab"+D+"Slider"]){B["_tab"+D+"Slider"]=$("#tab"+D+"BundleSlider").bxSlider({prevText:'<div class="prev hidden"><i class="prev-i"></i><i class="sd-icon sd-icon-previous"></i></div>',nextText:'<div class="next hidden"><i class="next-i"></i><i class="sd-icon sd-icon-next"></i></div>',useCSS:false,pager:false,slideMargin:0,hideControlOnEnd:true,infiniteLoop:false,auto:false,slideWidth:250,minSlides:4,maxSlides:5});setTimeout(function(){var E=B["_tab"+D+"Slider"].getSlideCount();var F=B["_tab"+D+"Slider"].parents(".bx-wrapper").find(".bx-controls");if(E>4){F.find(".prev").removeClass("hidden");F.find(".next").removeClass("hidden")}},100)}},400)},_isLoadingNewData:false,_clickedIndex:1,_tab1Slider:"",_tab2Slider:"",_tab3Slider:"",_tab1SliderStart:1,_tab2SliderStart:0,_tab3SliderStart:0,_getProducts:function(){if(B._isLoadingNewData||(B._clickedIndex==1&&B._tab1SliderStart>3)||(B._clickedIndex==2&&B._tab2SliderStart>3)||(B._clickedIndex==3&&B._tab3SliderStart>3)){return }B._isLoadingNewData=true;var E=0;if(B._clickedIndex==1){E=B._tab1SliderStart}else{if(B._clickedIndex==2){E=B._tab2SliderStart}else{E=B._tab3SliderStart}}var D=(Snapdeal.pdpConfigs&&Snapdeal.pdpConfigs["selectedSupc"])||B._supc;$.ajax({url:"/acors/web/getBundlingWidget/v2?supc="+D+"&index="+B._clickedIndex+"&start="+E+"&count=40",cache:true,type:"GET",success:function(G){B._isLoadingNewData=false;if(B._clickedIndex==1){B._tab1SliderStart++}else{if(B._clickedIndex==2){B._tab2SliderStart++}else{B._tab3SliderStart++}}if(!B["_tab"+B._clickedIndex+"Slider"]){var F=A.hardBundlingContainer;F.find("#tab"+B._clickedIndex+"BundleSlider").html(G);B._setTabSlider(B._clickedIndex)}else{B._reloadTabSlider(G)}},error:function(F){}})},_reloadTabSlider:function(E){if(E){$("#tab"+B._clickedIndex+"BundleSlider").append(E)}var D=B["_tab"+B._clickedIndex+"Slider"].getCurrentSlide();B["_tab"+B._clickedIndex+"Slider"].reloadSlider({prevText:'<div class="prev"><i class="prev-i"></i><i class="sd-icon sd-icon-previous"></i></div>',nextText:'<div class="next"><i class="next-i"></i><i class="sd-icon sd-icon-next"></i></div>',pager:false,slideMargin:0,hideControlOnEnd:true,auto:false,infiniteLoop:false,useCSS:false,startSlide:D,slideWidth:250,minSlides:4,maxSlides:5});setTimeout(function(){var F=B["_tab"+B._clickedIndex+"Slider"].getSlideCount();var G=B["_tab"+B._clickedIndex+"Slider"].parents(".bx-wrapper").find(".bx-controls");if(F>4){G.find(".prev").removeClass("hidden");G.find(".next").removeClass("hidden")}},100)},_checkPincodeAvailabe:function(){var E=Snapdeal.Cookie.get("spin");var D=(E)?E.split("-")[0]:"";if(D&&parseInt(D).toString().length==6){return D}return""},_selectedDom:"",_addToCartListener:function(){A.hardBundlingContainer.on("click.hardBundle",".pdpHardBundlingAddtoCart",function(H){var M=$(this);B._selectedDom=M;Snapdeal.omni.fire("addToCartHardBundlingDarwin",{catalogId:M.parents(".product-hover-state").find(".attributesBundle").attr("catalogid")});SDLogger.log("clickStream","addToCartBtnClick",{pogId:parseInt($(this).attr("pogid")),supc:$(this).attr("supc"),cartId:Snapdeal.Cookie.get("cartId")||"",vendorCodeValue:$(this).closest(".pdpHardBundlingParentContainer[data-vendorcode]").attr("data-vendorcode")});var G=Snapdeal.buyNowTellMeTile.checkAttrSelection();if(!G){return }var I=M.parents(".pdpHardBundlingParentContainer");var L=I.find(".attributesBundle");var D=I.find("img.product-image");var F=L.html();var K="";if(F){try{K=JSON.parse(F);if(K&&K.length){var J=Snapdeal.attributesTile.createFirstLevelAttrNonPdpPage(K,false,true,"","","");var E=$("#hardBundlingAttrPopup");E.find(".leftSide").append($("<img>",{src:D.attr("src")}));E.find(".rightsidename").append(I.find(".product-title:eq(0)").text());E.find(".rightsideattr").append($(J[0]));Snapdeal.sidebar.open($(E.html()),"Attribute Selection","");E.find(".leftSide").html("");E.find(".rightsidename").html("");E.find(".rightsideattr").html("")}else{Snapdeal.utility.displayPageLoader();Snapdeal.attributesTile.getNewVendorData(L.attr("supc"),"",B._checkPincodeAvailabe(),"","",0,1,true,false,false,false,true)}}catch(H){}}})}};C={init:function(){return B._init.apply(this,arguments)},checkPincodeAvailabe:function(){return B._checkPincodeAvailabe.apply(this,arguments)},setTabSlider:function(){return B._setTabSlider.apply(this,arguments)}};return C})(window.jQuery,Snapdeal);try{$("body").trigger("hardBundlingLoaded",[]);Snapdeal.hardBundlingLoaded=true}catch(e){};
